{
  "meta": {
    "project": "Canopus Works - Manufacturing Task Management System",
    "date": "2025-08-31",
    "prepared_by": "Generated by Software Development Manager"
  },
  "product_overview": "Canopus Works is a modern, scalable task management system tailored specifically for manufacturing workflows. It offers a Kanban-style interface, real-time updates, role-based access control, and supports team collaboration with advanced task and subtask management features. The system is built with Next.js 15, React 18, TypeScript, and backed by Supabase with PostgreSQL for a seamless, responsive, and secure user experience.",
  "core_goals": [
    "Provide an intuitive Kanban board interface for manufacturing task management.",
    "Enable real-time collaboration and updates among team members.",
    "Support role-based access and department-specific views for secure data handling.",
    "Facilitate comprehensive task and subtask tracking with drag-and-drop, status updates, and assignments.",
    "Ensure mobile responsiveness and accessibility on all devices.",
    "Maintain a secure and scalable backend using Supabase with PostgreSQL and robust authentication.",
    "Offer detailed audit trails and activity logs for compliance and quality control."
  ],
  "key_features": [
    "Complete user authentication system with sign-up, sign-in, password reset, and role-based access control using Supabase Auth.",
    "User profile management including role assignment, active/inactive status, and approval workflows.",
    "Kanban-style task management with drag-and-drop, task creation, editing, assignment, and status tracking.",
    "Hierarchical subtask system with assignment and completion tracking.",
    "Team collaboration tools including team member management and task assignments.",
    "Real-time comments on tasks and subtasks with user mentions.",
    "Notification system for user approvals, admin alerts, and system notifications.",
    "Dashboard analytics providing task summaries, statistics, and progress tracking.",
    "File upload functionality for user profile photos and attachments.",
    "Dark/light theme switching with system preference detection.",
    "Comprehensive UI component library built with Radix UI and Tailwind CSS for consistent and accessible design.",
    "Robust PostgreSQL database schema supporting users, tasks, subtasks, comments, notifications, and team members.",
    "Next.js API routes to support backend operations and integrations.",
    "Public landing page with sign-up and sign-in options focusing on user onboarding.",
    "Application layout with responsive navigation and header components.",
    "Error boundaries and error pages for graceful error handling and improved user experience."
  ],
  "user_flow_summary": [
    "User visits the public landing page and chooses to sign up or sign in via Supabase Auth.",
    "Upon authentication, users access the Kanban board dashboard with task summaries and analytics.",
    "Users can create, edit, assign, and track tasks and subtasks within the Kanban interface.",
    "Team members collaborate by commenting on tasks and subtasks in real-time, with user mentions.",
    "Notifications alert users and admins about approvals, updates, and system alerts.",
    "Users manage their profiles, upload photos, and adjust settings including theme preferences.",
    "Admins oversee user approvals, role assignments, and manage team members.",
    "In case of errors or not found pages, users see friendly error messages and recovery options."
  ],
  "validation_criteria": [
    "Successful user authentication and role-based access enforcement.",
    "Accurate creation, editing, assignment, and status tracking of tasks and subtasks.",
    "Real-time updates reflected in task comments and collaboration features.",
    "Responsive UI across devices including mobile and desktop.",
    "Correct functioning of notification system for various user and admin alerts.",
    "Consistent theming and user preference persistence for light/dark modes.",
    "Robust API and database operations with no data loss or corruption.",
    "Proper error handling with user-friendly error pages and messages.",
    "Complete audit logging for compliance tracking in manufacturing workflows.",
    "Efficient performance metrics including fast load times, smooth drag-and-drop, and minimal latency during real-time updates."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 15",
      "React 18",
      "Supabase",
      "PostgreSQL",
      "Tailwind CSS",
      "Radix UI",
      "pnpm",
      "Zod",
      "React Hook Form",
      "Lucide React"
    ],
    "features": [
      {
        "name": "Authentication System",
        "description": "Complete user authentication with Supabase Auth, including sign-up, sign-in, password reset, and role-based access control",
        "files": [
          "contexts/auth-context.tsx",
          "components/auth-guard.tsx",
          "components/enhanced-signup-form.tsx",
          "app/auth/callback/page.tsx",
          "app/auth/reset-password/page.tsx",
          "lib/supabase.ts"
        ]
      },
      {
        "name": "User Management",
        "description": "User profile management, role assignment, active/inactive status, and user approval workflow",
        "files": [
          "components/user-profile-dropdown.tsx",
          "app/api/create-user-profile/route.ts",
          "hooks/use-users.ts",
          "lib/team-members.ts"
        ]
      },
      {
        "name": "Task Management System",
        "description": "Kanban-style task management with drag-and-drop, task creation, editing, assignment, and status tracking",
        "files": [
          "components/kanban-board.tsx",
          "components/task-card.tsx",
          "components/task-modal.tsx",
          "components/add-task-button.tsx",
          "contexts/task-context.tsx",
          "hooks/use-tasks.ts",
          "hooks/use-task-assignments.ts",
          "lib/task-mappers.ts"
        ]
      },
      {
        "name": "Subtask System",
        "description": "Hierarchical task management with subtasks, assignments, and completion tracking",
        "files": [
          "components/subtask-list.tsx",
          "components/subtask-comments-modal.tsx",
          "hooks/use-subtask-assignments.ts"
        ]
      },
      {
        "name": "Team Collaboration",
        "description": "Team member management, assignments, and collaboration features",
        "files": [
          "components/team-members-modal.tsx",
          "hooks/use-team-members.ts"
        ]
      },
      {
        "name": "Comments System",
        "description": "Real-time comments on tasks and subtasks with user mentions",
        "files": [
          "components/comments-section.tsx"
        ]
      },
      {
        "name": "Notification System",
        "description": "User approval notifications, admin notifications, and system alerts",
        "files": [
          "components/user-profile-dropdown.tsx"
        ]
      },
      {
        "name": "Dashboard Analytics",
        "description": "Task summary dashboard with statistics and progress tracking",
        "files": [
          "components/dashboard-summary.tsx",
          "app/dashboard/page.tsx"
        ]
      },
      {
        "name": "File Upload System",
        "description": "Photo upload functionality for user profiles",
        "files": [
          "components/photo-upload.tsx"
        ]
      },
      {
        "name": "Theme Management",
        "description": "Dark/light theme switching with system preference detection",
        "files": [
          "components/theme-provider.tsx",
          "hooks/use-mobile.ts"
        ]
      },
      {
        "name": "UI Components",
        "description": "Comprehensive UI component library built with Radix UI and Tailwind CSS",
        "files": [
          "components/ui/button.tsx",
          "components/ui/card.tsx",
          "components/ui/dialog.tsx",
          "components/ui/form.tsx",
          "components/ui/input.tsx",
          "components/ui/select.tsx",
          "components/ui/badge.tsx",
          "components/ui/switch.tsx",
          "components/ui/toast.tsx",
          "components/ui/avatar.tsx",
          "components/ui/dropdown-menu.tsx",
          "components/ui/tabs.tsx",
          "components/ui/accordion.tsx",
          "components/ui/alert.tsx",
          "components/ui/calendar.tsx",
          "components/ui/checkbox.tsx",
          "components/ui/command.tsx",
          "components/ui/context-menu.tsx",
          "components/ui/drawer.tsx",
          "components/ui/hover-card.tsx",
          "components/ui/label.tsx",
          "components/ui/menubar.tsx",
          "components/ui/navigation-menu.tsx",
          "components/ui/pagination.tsx",
          "components/ui/popover.tsx",
          "components/ui/progress.tsx",
          "components/ui/radio-group.tsx",
          "components/ui/resizable.tsx",
          "components/ui/scroll-area.tsx",
          "components/ui/separator.tsx",
          "components/ui/sheet.tsx",
          "components/ui/sidebar.tsx",
          "components/ui/skeleton.tsx",
          "components/ui/slider.tsx",
          "components/ui/sonner.tsx",
          "components/ui/table.tsx",
          "components/ui/textarea.tsx",
          "components/ui/toggle.tsx",
          "components/ui/toggle-group.tsx",
          "components/ui/tooltip.tsx"
        ]
      },
      {
        "name": "Database Schema",
        "description": "PostgreSQL database schema with users, tasks, subtasks, comments, notifications, and team members tables",
        "files": [
          "supabase/migrations/001_initial_schema.sql",
          "supabase/migrations/002_rls_policies.sql",
          "supabase/migrations/003_functions.sql",
          "supabase/migrations/036_enhanced_user_approval_system.sql",
          "supabase/migrations/037_update_create_user_with_invitation.sql",
          "supabase/migrations/038_remove_email_verified_unique_constraint.sql",
          "supabase/migrations/039_update_rls_for_user_creation.sql",
          "supabase/migrations/040_fix_function_search_path_security_issues.sql",
          "supabase/migrations/041_fix_pending_user_approvals_view_security.sql",
          "supabase/migrations/042_update_rls_for_user_creation_v2.sql",
          "supabase/migrations/043_fix_handle_new_user_trigger_function.sql"
        ]
      },
      {
        "name": "API Routes",
        "description": "Next.js API routes for user profile creation and other backend operations",
        "files": [
          "app/api/create-user-profile/route.ts"
        ]
      },
      {
        "name": "Landing Page",
        "description": "Public landing page with sign-up and sign-in options",
        "files": [
          "app/page.tsx",
          "components/landing-page.tsx",
          "components/simple-landing-page.tsx",
          "components/login-button.tsx"
        ]
      },
      {
        "name": "Layout and Navigation",
        "description": "Application layout, header, and navigation components",
        "files": [
          "app/layout.tsx",
          "components/header.tsx",
          "app/kanban/page.tsx"
        ]
      },
      {
        "name": "Error Handling",
        "description": "Error boundaries and error pages for graceful error handling",
        "files": [
          "app/error.tsx",
          "app/global-error.tsx",
          "app/not-found.tsx"
        ]
      },
      {
        "name": "Utility Functions",
        "description": "Helper functions and utilities for common operations",
        "files": [
          "lib/utils.ts",
          "hooks/use-toast.ts"
        ]
      }
    ]
  }
}
